#ifndef DCT8X8_H
#define DCT8X8_H

#include <array>

namespace dct {

constexpr int DCT_RSC_FACTOR = 8192;

constexpr int DCT_RESCALE(int v) {
	return (v > 0 ? v + DCT_RSC_FACTOR / 2 : v - DCT_RSC_FACTOR / 2) / DCT_RSC_FACTOR;
}


// Precalculated int values for 8x8 IDCT, multplied by 8192:
constexpr std::array<int, 4096> icos_idct_8x8 =
{
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 1420,  1970,  1856,  1670,  1420,  1116,   769,   392, 
	 1338,  1856,  1748,  1573,  1338,  1051,   724,   369, 
	 1204,  1670,  1573,  1416,  1204,   946,   652,   332, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	  805,  1116,  1051,   946,   805,   632,   435,   222, 
	  554,   769,   724,   652,   554,   435,   300,   153, 
	  283,   392,   369,   332,   283,   222,   153,    78, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 1420,  1670,   769,  -392, -1420, -1970, -1856, -1116, 
	 1338,  1573,   724,  -369, -1338, -1856, -1748, -1051, 
	 1204,  1416,   652,  -332, -1204, -1670, -1573,  -946, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	  805,   946,   435,  -222,  -805, -1116, -1051,  -632, 
	  554,   652,   300,  -153,  -554,  -769,  -724,  -435, 
	  283,   332,   153,   -78,  -283,  -392,  -369,  -222, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 1420,  1116,  -769, -1970, -1420,   392,  1856,  1670, 
	 1338,  1051,  -724, -1856, -1338,   369,  1748,  1573, 
	 1204,   946,  -652, -1670, -1204,   332,  1573,  1416, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	  805,   632,  -435, -1116,  -805,   222,  1051,   946, 
	  554,   435,  -300,  -769,  -554,   153,   724,   652, 
	  283,   222,  -153,  -392,  -283,    78,   369,   332, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 1420,   392, -1856, -1116,  1420,  1670,  -769, -1970, 
	 1338,   369, -1748, -1051,  1338,  1573,  -724, -1856, 
	 1204,   332, -1573,  -946,  1204,  1416,  -652, -1670, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	  805,   222, -1051,  -632,   805,   946,  -435, -1116, 
	  554,   153,  -724,  -435,   554,   652,  -300,  -769, 
	  283,    78,  -369,  -222,   283,   332,  -153,  -392, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 1420,  -392, -1856,  1116,  1420, -1670,  -769,  1970, 
	 1338,  -369, -1748,  1051,  1338, -1573,  -724,  1856, 
	 1204,  -332, -1573,   946,  1204, -1416,  -652,  1670, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	  805,  -222, -1051,   632,   805,  -946,  -435,  1116, 
	  554,  -153,  -724,   435,   554,  -652,  -300,   769, 
	  283,   -78,  -369,   222,   283,  -332,  -153,   392, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 1420, -1116,  -769,  1970, -1420,  -392,  1856, -1670, 
	 1338, -1051,  -724,  1856, -1338,  -369,  1748, -1573, 
	 1204,  -946,  -652,  1670, -1204,  -332,  1573, -1416, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	  805,  -632,  -435,  1116,  -805,  -222,  1051,  -946, 
	  554,  -435,  -300,   769,  -554,  -153,   724,  -652, 
	  283,  -222,  -153,   392,  -283,   -78,   369,  -332, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 1420, -1670,   769,   392, -1420,  1970, -1856,  1116, 
	 1338, -1573,   724,   369, -1338,  1856, -1748,  1051, 
	 1204, -1416,   652,   332, -1204,  1670, -1573,   946, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	  805,  -946,   435,   222,  -805,  1116, -1051,   632, 
	  554,  -652,   300,   153,  -554,   769,  -724,   435, 
	  283,  -332,   153,    78,  -283,   392,  -369,   222, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	 1420, -1970,  1856, -1670,  1420, -1116,   769,  -392, 
	 1338, -1856,  1748, -1573,  1338, -1051,   724,  -369, 
	 1204, -1670,  1573, -1416,  1204,  -946,   652,  -332, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	  805, -1116,  1051,  -946,   805,  -632,   435,  -222, 
	  554,  -769,   724,  -652,   554,  -435,   300,  -153, 
	  283,  -392,   369,  -332,   283,  -222,   153,   -78, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 1204,  1670,  1573,  1416,  1204,   946,   652,   332, 
	  554,   769,   724,   652,   554,   435,   300,   153, 
	 -283,  -392,  -369,  -332,  -283,  -222,  -153,   -78, 
	-1024, -1420, -1338, -1204, -1024,  -805,  -554,  -283, 
	-1420, -1970, -1856, -1670, -1420, -1116,  -769,  -392, 
	-1338, -1856, -1748, -1573, -1338, -1051,  -724,  -369, 
	 -805, -1116, -1051,  -946,  -805,  -632,  -435,  -222, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 1204,  1416,   652,  -332, -1204, -1670, -1573,  -946, 
	  554,   652,   300,  -153,  -554,  -769,  -724,  -435, 
	 -283,  -332,  -153,    78,   283,   392,   369,   222, 
	-1024, -1204,  -554,   283,  1024,  1420,  1338,   805, 
	-1420, -1670,  -769,   392,  1420,  1970,  1856,  1116, 
	-1338, -1573,  -724,   369,  1338,  1856,  1748,  1051, 
	 -805,  -946,  -435,   222,   805,  1116,  1051,   632, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 1204,   946,  -652, -1670, -1204,   332,  1573,  1416, 
	  554,   435,  -300,  -769,  -554,   153,   724,   652, 
	 -283,  -222,   153,   392,   283,   -78,  -369,  -332, 
	-1024,  -805,   554,  1420,  1024,  -283, -1338, -1204, 
	-1420, -1116,   769,  1970,  1420,  -392, -1856, -1670, 
	-1338, -1051,   724,  1856,  1338,  -369, -1748, -1573, 
	 -805,  -632,   435,  1116,   805,  -222, -1051,  -946, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 1204,   332, -1573,  -946,  1204,  1416,  -652, -1670, 
	  554,   153,  -724,  -435,   554,   652,  -300,  -769, 
	 -283,   -78,   369,   222,  -283,  -332,   153,   392, 
	-1024,  -283,  1338,   805, -1024, -1204,   554,  1420, 
	-1420,  -392,  1856,  1116, -1420, -1670,   769,  1970, 
	-1338,  -369,  1748,  1051, -1338, -1573,   724,  1856, 
	 -805,  -222,  1051,   632,  -805,  -946,   435,  1116, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 1204,  -332, -1573,   946,  1204, -1416,  -652,  1670, 
	  554,  -153,  -724,   435,   554,  -652,  -300,   769, 
	 -283,    78,   369,  -222,  -283,   332,   153,  -392, 
	-1024,   283,  1338,  -805, -1024,  1204,   554, -1420, 
	-1420,   392,  1856, -1116, -1420,  1670,   769, -1970, 
	-1338,   369,  1748, -1051, -1338,  1573,   724, -1856, 
	 -805,   222,  1051,  -632,  -805,   946,   435, -1116, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 1204,  -946,  -652,  1670, -1204,  -332,  1573, -1416, 
	  554,  -435,  -300,   769,  -554,  -153,   724,  -652, 
	 -283,   222,   153,  -392,   283,    78,  -369,   332, 
	-1024,   805,   554, -1420,  1024,   283, -1338,  1204, 
	-1420,  1116,   769, -1970,  1420,   392, -1856,  1670, 
	-1338,  1051,   724, -1856,  1338,   369, -1748,  1573, 
	 -805,   632,   435, -1116,   805,   222, -1051,   946, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 1204, -1416,   652,   332, -1204,  1670, -1573,   946, 
	  554,  -652,   300,   153,  -554,   769,  -724,   435, 
	 -283,   332,  -153,   -78,   283,  -392,   369,  -222, 
	-1024,  1204,  -554,  -283,  1024, -1420,  1338,  -805, 
	-1420,  1670,  -769,  -392,  1420, -1970,  1856, -1116, 
	-1338,  1573,  -724,  -369,  1338, -1856,  1748, -1051, 
	 -805,   946,  -435,  -222,   805, -1116,  1051,  -632, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	 1204, -1670,  1573, -1416,  1204,  -946,   652,  -332, 
	  554,  -769,   724,  -652,   554,  -435,   300,  -153, 
	 -283,   392,  -369,   332,  -283,   222,  -153,    78, 
	-1024,  1420, -1338,  1204, -1024,   805,  -554,   283, 
	-1420,  1970, -1856,  1670, -1420,  1116,  -769,   392, 
	-1338,  1856, -1748,  1573, -1338,  1051,  -724,   369, 
	 -805,  1116, -1051,   946,  -805,   632,  -435,   222, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	  805,  1116,  1051,   946,   805,   632,   435,   222, 
	 -554,  -769,  -724,  -652,  -554,  -435,  -300,  -153, 
	-1420, -1970, -1856, -1670, -1420, -1116,  -769,  -392, 
	-1024, -1420, -1338, -1204, -1024,  -805,  -554,  -283, 
	  283,   392,   369,   332,   283,   222,   153,    78, 
	 1338,  1856,  1748,  1573,  1338,  1051,   724,   369, 
	 1204,  1670,  1573,  1416,  1204,   946,   652,   332, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	  805,   946,   435,  -222,  -805, -1116, -1051,  -632, 
	 -554,  -652,  -300,   153,   554,   769,   724,   435, 
	-1420, -1670,  -769,   392,  1420,  1970,  1856,  1116, 
	-1024, -1204,  -554,   283,  1024,  1420,  1338,   805, 
	  283,   332,   153,   -78,  -283,  -392,  -369,  -222, 
	 1338,  1573,   724,  -369, -1338, -1856, -1748, -1051, 
	 1204,  1416,   652,  -332, -1204, -1670, -1573,  -946, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	  805,   632,  -435, -1116,  -805,   222,  1051,   946, 
	 -554,  -435,   300,   769,   554,  -153,  -724,  -652, 
	-1420, -1116,   769,  1970,  1420,  -392, -1856, -1670, 
	-1024,  -805,   554,  1420,  1024,  -283, -1338, -1204, 
	  283,   222,  -153,  -392,  -283,    78,   369,   332, 
	 1338,  1051,  -724, -1856, -1338,   369,  1748,  1573, 
	 1204,   946,  -652, -1670, -1204,   332,  1573,  1416, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	  805,   222, -1051,  -632,   805,   946,  -435, -1116, 
	 -554,  -153,   724,   435,  -554,  -652,   300,   769, 
	-1420,  -392,  1856,  1116, -1420, -1670,   769,  1970, 
	-1024,  -283,  1338,   805, -1024, -1204,   554,  1420, 
	  283,    78,  -369,  -222,   283,   332,  -153,  -392, 
	 1338,   369, -1748, -1051,  1338,  1573,  -724, -1856, 
	 1204,   332, -1573,  -946,  1204,  1416,  -652, -1670, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	  805,  -222, -1051,   632,   805,  -946,  -435,  1116, 
	 -554,   153,   724,  -435,  -554,   652,   300,  -769, 
	-1420,   392,  1856, -1116, -1420,  1670,   769, -1970, 
	-1024,   283,  1338,  -805, -1024,  1204,   554, -1420, 
	  283,   -78,  -369,   222,   283,  -332,  -153,   392, 
	 1338,  -369, -1748,  1051,  1338, -1573,  -724,  1856, 
	 1204,  -332, -1573,   946,  1204, -1416,  -652,  1670, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	  805,  -632,  -435,  1116,  -805,  -222,  1051,  -946, 
	 -554,   435,   300,  -769,   554,   153,  -724,   652, 
	-1420,  1116,   769, -1970,  1420,   392, -1856,  1670, 
	-1024,   805,   554, -1420,  1024,   283, -1338,  1204, 
	  283,  -222,  -153,   392,  -283,   -78,   369,  -332, 
	 1338, -1051,  -724,  1856, -1338,  -369,  1748, -1573, 
	 1204,  -946,  -652,  1670, -1204,  -332,  1573, -1416, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	  805,  -946,   435,   222,  -805,  1116, -1051,   632, 
	 -554,   652,  -300,  -153,   554,  -769,   724,  -435, 
	-1420,  1670,  -769,  -392,  1420, -1970,  1856, -1116, 
	-1024,  1204,  -554,  -283,  1024, -1420,  1338,  -805, 
	  283,  -332,   153,    78,  -283,   392,  -369,   222, 
	 1338, -1573,   724,   369, -1338,  1856, -1748,  1051, 
	 1204, -1416,   652,   332, -1204,  1670, -1573,   946, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	  805, -1116,  1051,  -946,   805,  -632,   435,  -222, 
	 -554,   769,  -724,   652,  -554,   435,  -300,   153, 
	-1420,  1970, -1856,  1670, -1420,  1116,  -769,   392, 
	-1024,  1420, -1338,  1204, -1024,   805,  -554,   283, 
	  283,  -392,   369,  -332,   283,  -222,   153,   -78, 
	 1338, -1856,  1748, -1573,  1338, -1051,   724,  -369, 
	 1204, -1670,  1573, -1416,  1204,  -946,   652,  -332, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	  283,   392,   369,   332,   283,   222,   153,    78, 
	-1338, -1856, -1748, -1573, -1338, -1051,  -724,  -369, 
	 -805, -1116, -1051,  -946,  -805,  -632,  -435,  -222, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 1204,  1670,  1573,  1416,  1204,   946,   652,   332, 
	 -554,  -769,  -724,  -652,  -554,  -435,  -300,  -153, 
	-1420, -1970, -1856, -1670, -1420, -1116,  -769,  -392, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	  283,   332,   153,   -78,  -283,  -392,  -369,  -222, 
	-1338, -1573,  -724,   369,  1338,  1856,  1748,  1051, 
	 -805,  -946,  -435,   222,   805,  1116,  1051,   632, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 1204,  1416,   652,  -332, -1204, -1670, -1573,  -946, 
	 -554,  -652,  -300,   153,   554,   769,   724,   435, 
	-1420, -1670,  -769,   392,  1420,  1970,  1856,  1116, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	  283,   222,  -153,  -392,  -283,    78,   369,   332, 
	-1338, -1051,   724,  1856,  1338,  -369, -1748, -1573, 
	 -805,  -632,   435,  1116,   805,  -222, -1051,  -946, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 1204,   946,  -652, -1670, -1204,   332,  1573,  1416, 
	 -554,  -435,   300,   769,   554,  -153,  -724,  -652, 
	-1420, -1116,   769,  1970,  1420,  -392, -1856, -1670, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	  283,    78,  -369,  -222,   283,   332,  -153,  -392, 
	-1338,  -369,  1748,  1051, -1338, -1573,   724,  1856, 
	 -805,  -222,  1051,   632,  -805,  -946,   435,  1116, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 1204,   332, -1573,  -946,  1204,  1416,  -652, -1670, 
	 -554,  -153,   724,   435,  -554,  -652,   300,   769, 
	-1420,  -392,  1856,  1116, -1420, -1670,   769,  1970, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	  283,   -78,  -369,   222,   283,  -332,  -153,   392, 
	-1338,   369,  1748, -1051, -1338,  1573,   724, -1856, 
	 -805,   222,  1051,  -632,  -805,   946,   435, -1116, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 1204,  -332, -1573,   946,  1204, -1416,  -652,  1670, 
	 -554,   153,   724,  -435,  -554,   652,   300,  -769, 
	-1420,   392,  1856, -1116, -1420,  1670,   769, -1970, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	  283,  -222,  -153,   392,  -283,   -78,   369,  -332, 
	-1338,  1051,   724, -1856,  1338,   369, -1748,  1573, 
	 -805,   632,   435, -1116,   805,   222, -1051,   946, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 1204,  -946,  -652,  1670, -1204,  -332,  1573, -1416, 
	 -554,   435,   300,  -769,   554,   153,  -724,   652, 
	-1420,  1116,   769, -1970,  1420,   392, -1856,  1670, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	  283,  -332,   153,    78,  -283,   392,  -369,   222, 
	-1338,  1573,  -724,  -369,  1338, -1856,  1748, -1051, 
	 -805,   946,  -435,  -222,   805, -1116,  1051,  -632, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 1204, -1416,   652,   332, -1204,  1670, -1573,   946, 
	 -554,   652,  -300,  -153,   554,  -769,   724,  -435, 
	-1420,  1670,  -769,  -392,  1420, -1970,  1856, -1116, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	  283,  -392,   369,  -332,   283,  -222,   153,   -78, 
	-1338,  1856, -1748,  1573, -1338,  1051,  -724,   369, 
	 -805,  1116, -1051,   946,  -805,   632,  -435,   222, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	 1204, -1670,  1573, -1416,  1204,  -946,   652,  -332, 
	 -554,   769,  -724,   652,  -554,   435,  -300,   153, 
	-1420,  1970, -1856,  1670, -1420,  1116,  -769,   392, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 -283,  -392,  -369,  -332,  -283,  -222,  -153,   -78, 
	-1338, -1856, -1748, -1573, -1338, -1051,  -724,  -369, 
	  805,  1116,  1051,   946,   805,   632,   435,   222, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	-1204, -1670, -1573, -1416, -1204,  -946,  -652,  -332, 
	 -554,  -769,  -724,  -652,  -554,  -435,  -300,  -153, 
	 1420,  1970,  1856,  1670,  1420,  1116,   769,   392, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 -283,  -332,  -153,    78,   283,   392,   369,   222, 
	-1338, -1573,  -724,   369,  1338,  1856,  1748,  1051, 
	  805,   946,   435,  -222,  -805, -1116, -1051,  -632, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	-1204, -1416,  -652,   332,  1204,  1670,  1573,   946, 
	 -554,  -652,  -300,   153,   554,   769,   724,   435, 
	 1420,  1670,   769,  -392, -1420, -1970, -1856, -1116, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 -283,  -222,   153,   392,   283,   -78,  -369,  -332, 
	-1338, -1051,   724,  1856,  1338,  -369, -1748, -1573, 
	  805,   632,  -435, -1116,  -805,   222,  1051,   946, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	-1204,  -946,   652,  1670,  1204,  -332, -1573, -1416, 
	 -554,  -435,   300,   769,   554,  -153,  -724,  -652, 
	 1420,  1116,  -769, -1970, -1420,   392,  1856,  1670, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 -283,   -78,   369,   222,  -283,  -332,   153,   392, 
	-1338,  -369,  1748,  1051, -1338, -1573,   724,  1856, 
	  805,   222, -1051,  -632,   805,   946,  -435, -1116, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	-1204,  -332,  1573,   946, -1204, -1416,   652,  1670, 
	 -554,  -153,   724,   435,  -554,  -652,   300,   769, 
	 1420,   392, -1856, -1116,  1420,  1670,  -769, -1970, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 -283,    78,   369,  -222,  -283,   332,   153,  -392, 
	-1338,   369,  1748, -1051, -1338,  1573,   724, -1856, 
	  805,  -222, -1051,   632,   805,  -946,  -435,  1116, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	-1204,   332,  1573,  -946, -1204,  1416,   652, -1670, 
	 -554,   153,   724,  -435,  -554,   652,   300,  -769, 
	 1420,  -392, -1856,  1116,  1420, -1670,  -769,  1970, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 -283,   222,   153,  -392,   283,    78,  -369,   332, 
	-1338,  1051,   724, -1856,  1338,   369, -1748,  1573, 
	  805,  -632,  -435,  1116,  -805,  -222,  1051,  -946, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	-1204,   946,   652, -1670,  1204,   332, -1573,  1416, 
	 -554,   435,   300,  -769,   554,   153,  -724,   652, 
	 1420, -1116,  -769,  1970, -1420,  -392,  1856, -1670, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 -283,   332,  -153,   -78,   283,  -392,   369,  -222, 
	-1338,  1573,  -724,  -369,  1338, -1856,  1748, -1051, 
	  805,  -946,   435,   222,  -805,  1116, -1051,   632, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	-1204,  1416,  -652,  -332,  1204, -1670,  1573,  -946, 
	 -554,   652,  -300,  -153,   554,  -769,   724,  -435, 
	 1420, -1670,   769,   392, -1420,  1970, -1856,  1116, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	 -283,   392,  -369,   332,  -283,   222,  -153,    78, 
	-1338,  1856, -1748,  1573, -1338,  1051,  -724,   369, 
	  805, -1116,  1051,  -946,   805,  -632,   435,  -222, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	-1204,  1670, -1573,  1416, -1204,   946,  -652,   332, 
	 -554,   769,  -724,   652,  -554,   435,  -300,   153, 
	 1420, -1970,  1856, -1670,  1420, -1116,   769,  -392, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 -805, -1116, -1051,  -946,  -805,  -632,  -435,  -222, 
	 -554,  -769,  -724,  -652,  -554,  -435,  -300,  -153, 
	 1420,  1970,  1856,  1670,  1420,  1116,   769,   392, 
	-1024, -1420, -1338, -1204, -1024,  -805,  -554,  -283, 
	 -283,  -392,  -369,  -332,  -283,  -222,  -153,   -78, 
	 1338,  1856,  1748,  1573,  1338,  1051,   724,   369, 
	-1204, -1670, -1573, -1416, -1204,  -946,  -652,  -332, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 -805,  -946,  -435,   222,   805,  1116,  1051,   632, 
	 -554,  -652,  -300,   153,   554,   769,   724,   435, 
	 1420,  1670,   769,  -392, -1420, -1970, -1856, -1116, 
	-1024, -1204,  -554,   283,  1024,  1420,  1338,   805, 
	 -283,  -332,  -153,    78,   283,   392,   369,   222, 
	 1338,  1573,   724,  -369, -1338, -1856, -1748, -1051, 
	-1204, -1416,  -652,   332,  1204,  1670,  1573,   946, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 -805,  -632,   435,  1116,   805,  -222, -1051,  -946, 
	 -554,  -435,   300,   769,   554,  -153,  -724,  -652, 
	 1420,  1116,  -769, -1970, -1420,   392,  1856,  1670, 
	-1024,  -805,   554,  1420,  1024,  -283, -1338, -1204, 
	 -283,  -222,   153,   392,   283,   -78,  -369,  -332, 
	 1338,  1051,  -724, -1856, -1338,   369,  1748,  1573, 
	-1204,  -946,   652,  1670,  1204,  -332, -1573, -1416, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 -805,  -222,  1051,   632,  -805,  -946,   435,  1116, 
	 -554,  -153,   724,   435,  -554,  -652,   300,   769, 
	 1420,   392, -1856, -1116,  1420,  1670,  -769, -1970, 
	-1024,  -283,  1338,   805, -1024, -1204,   554,  1420, 
	 -283,   -78,   369,   222,  -283,  -332,   153,   392, 
	 1338,   369, -1748, -1051,  1338,  1573,  -724, -1856, 
	-1204,  -332,  1573,   946, -1204, -1416,   652,  1670, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 -805,   222,  1051,  -632,  -805,   946,   435, -1116, 
	 -554,   153,   724,  -435,  -554,   652,   300,  -769, 
	 1420,  -392, -1856,  1116,  1420, -1670,  -769,  1970, 
	-1024,   283,  1338,  -805, -1024,  1204,   554, -1420, 
	 -283,    78,   369,  -222,  -283,   332,   153,  -392, 
	 1338,  -369, -1748,  1051,  1338, -1573,  -724,  1856, 
	-1204,   332,  1573,  -946, -1204,  1416,   652, -1670, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 -805,   632,   435, -1116,   805,   222, -1051,   946, 
	 -554,   435,   300,  -769,   554,   153,  -724,   652, 
	 1420, -1116,  -769,  1970, -1420,  -392,  1856, -1670, 
	-1024,   805,   554, -1420,  1024,   283, -1338,  1204, 
	 -283,   222,   153,  -392,   283,    78,  -369,   332, 
	 1338, -1051,  -724,  1856, -1338,  -369,  1748, -1573, 
	-1204,   946,   652, -1670,  1204,   332, -1573,  1416, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 -805,   946,  -435,  -222,   805, -1116,  1051,  -632, 
	 -554,   652,  -300,  -153,   554,  -769,   724,  -435, 
	 1420, -1670,   769,   392, -1420,  1970, -1856,  1116, 
	-1024,  1204,  -554,  -283,  1024, -1420,  1338,  -805, 
	 -283,   332,  -153,   -78,   283,  -392,   369,  -222, 
	 1338, -1573,   724,   369, -1338,  1856, -1748,  1051, 
	-1204,  1416,  -652,  -332,  1204, -1670,  1573,  -946, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	 -805,  1116, -1051,   946,  -805,   632,  -435,   222, 
	 -554,   769,  -724,   652,  -554,   435,  -300,   153, 
	 1420, -1970,  1856, -1670,  1420, -1116,   769,  -392, 
	-1024,  1420, -1338,  1204, -1024,   805,  -554,   283, 
	 -283,   392,  -369,   332,  -283,   222,  -153,    78, 
	 1338, -1856,  1748, -1573,  1338, -1051,   724,  -369, 
	-1204,  1670, -1573,  1416, -1204,   946,  -652,   332, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	-1204, -1670, -1573, -1416, -1204,  -946,  -652,  -332, 
	  554,   769,   724,   652,   554,   435,   300,   153, 
	  283,   392,   369,   332,   283,   222,   153,    78, 
	-1024, -1420, -1338, -1204, -1024,  -805,  -554,  -283, 
	 1420,  1970,  1856,  1670,  1420,  1116,   769,   392, 
	-1338, -1856, -1748, -1573, -1338, -1051,  -724,  -369, 
	  805,  1116,  1051,   946,   805,   632,   435,   222, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	-1204, -1416,  -652,   332,  1204,  1670,  1573,   946, 
	  554,   652,   300,  -153,  -554,  -769,  -724,  -435, 
	  283,   332,   153,   -78,  -283,  -392,  -369,  -222, 
	-1024, -1204,  -554,   283,  1024,  1420,  1338,   805, 
	 1420,  1670,   769,  -392, -1420, -1970, -1856, -1116, 
	-1338, -1573,  -724,   369,  1338,  1856,  1748,  1051, 
	  805,   946,   435,  -222,  -805, -1116, -1051,  -632, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	-1204,  -946,   652,  1670,  1204,  -332, -1573, -1416, 
	  554,   435,  -300,  -769,  -554,   153,   724,   652, 
	  283,   222,  -153,  -392,  -283,    78,   369,   332, 
	-1024,  -805,   554,  1420,  1024,  -283, -1338, -1204, 
	 1420,  1116,  -769, -1970, -1420,   392,  1856,  1670, 
	-1338, -1051,   724,  1856,  1338,  -369, -1748, -1573, 
	  805,   632,  -435, -1116,  -805,   222,  1051,   946, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	-1204,  -332,  1573,   946, -1204, -1416,   652,  1670, 
	  554,   153,  -724,  -435,   554,   652,  -300,  -769, 
	  283,    78,  -369,  -222,   283,   332,  -153,  -392, 
	-1024,  -283,  1338,   805, -1024, -1204,   554,  1420, 
	 1420,   392, -1856, -1116,  1420,  1670,  -769, -1970, 
	-1338,  -369,  1748,  1051, -1338, -1573,   724,  1856, 
	  805,   222, -1051,  -632,   805,   946,  -435, -1116, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	-1204,   332,  1573,  -946, -1204,  1416,   652, -1670, 
	  554,  -153,  -724,   435,   554,  -652,  -300,   769, 
	  283,   -78,  -369,   222,   283,  -332,  -153,   392, 
	-1024,   283,  1338,  -805, -1024,  1204,   554, -1420, 
	 1420,  -392, -1856,  1116,  1420, -1670,  -769,  1970, 
	-1338,   369,  1748, -1051, -1338,  1573,   724, -1856, 
	  805,  -222, -1051,   632,   805,  -946,  -435,  1116, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	-1204,   946,   652, -1670,  1204,   332, -1573,  1416, 
	  554,  -435,  -300,   769,  -554,  -153,   724,  -652, 
	  283,  -222,  -153,   392,  -283,   -78,   369,  -332, 
	-1024,   805,   554, -1420,  1024,   283, -1338,  1204, 
	 1420, -1116,  -769,  1970, -1420,  -392,  1856, -1670, 
	-1338,  1051,   724, -1856,  1338,   369, -1748,  1573, 
	  805,  -632,  -435,  1116,  -805,  -222,  1051,  -946, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	-1204,  1416,  -652,  -332,  1204, -1670,  1573,  -946, 
	  554,  -652,   300,   153,  -554,   769,  -724,   435, 
	  283,  -332,   153,    78,  -283,   392,  -369,   222, 
	-1024,  1204,  -554,  -283,  1024, -1420,  1338,  -805, 
	 1420, -1670,   769,   392, -1420,  1970, -1856,  1116, 
	-1338,  1573,  -724,  -369,  1338, -1856,  1748, -1051, 
	  805,  -946,   435,   222,  -805,  1116, -1051,   632, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	-1204,  1670, -1573,  1416, -1204,   946,  -652,   332, 
	  554,  -769,   724,  -652,   554,  -435,   300,  -153, 
	  283,  -392,   369,  -332,   283,  -222,   153,   -78, 
	-1024,  1420, -1338,  1204, -1024,   805,  -554,   283, 
	 1420, -1970,  1856, -1670,  1420, -1116,   769,  -392, 
	-1338,  1856, -1748,  1573, -1338,  1051,  -724,   369, 
	  805, -1116,  1051,  -946,   805,  -632,   435,  -222, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	-1420, -1970, -1856, -1670, -1420, -1116,  -769,  -392, 
	 1338,  1856,  1748,  1573,  1338,  1051,   724,   369, 
	-1204, -1670, -1573, -1416, -1204,  -946,  -652,  -332, 
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 -805, -1116, -1051,  -946,  -805,  -632,  -435,  -222, 
	  554,   769,   724,   652,   554,   435,   300,   153, 
	 -283,  -392,  -369,  -332,  -283,  -222,  -153,   -78, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	-1420, -1670,  -769,   392,  1420,  1970,  1856,  1116, 
	 1338,  1573,   724,  -369, -1338, -1856, -1748, -1051, 
	-1204, -1416,  -652,   332,  1204,  1670,  1573,   946, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 -805,  -946,  -435,   222,   805,  1116,  1051,   632, 
	  554,   652,   300,  -153,  -554,  -769,  -724,  -435, 
	 -283,  -332,  -153,    78,   283,   392,   369,   222, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	-1420, -1116,   769,  1970,  1420,  -392, -1856, -1670, 
	 1338,  1051,  -724, -1856, -1338,   369,  1748,  1573, 
	-1204,  -946,   652,  1670,  1204,  -332, -1573, -1416, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 -805,  -632,   435,  1116,   805,  -222, -1051,  -946, 
	  554,   435,  -300,  -769,  -554,   153,   724,   652, 
	 -283,  -222,   153,   392,   283,   -78,  -369,  -332, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	-1420,  -392,  1856,  1116, -1420, -1670,   769,  1970, 
	 1338,   369, -1748, -1051,  1338,  1573,  -724, -1856, 
	-1204,  -332,  1573,   946, -1204, -1416,   652,  1670, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 -805,  -222,  1051,   632,  -805,  -946,   435,  1116, 
	  554,   153,  -724,  -435,   554,   652,  -300,  -769, 
	 -283,   -78,   369,   222,  -283,  -332,   153,   392, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	-1420,   392,  1856, -1116, -1420,  1670,   769, -1970, 
	 1338,  -369, -1748,  1051,  1338, -1573,  -724,  1856, 
	-1204,   332,  1573,  -946, -1204,  1416,   652, -1670, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 -805,   222,  1051,  -632,  -805,   946,   435, -1116, 
	  554,  -153,  -724,   435,   554,  -652,  -300,   769, 
	 -283,    78,   369,  -222,  -283,   332,   153,  -392, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	-1420,  1116,   769, -1970,  1420,   392, -1856,  1670, 
	 1338, -1051,  -724,  1856, -1338,  -369,  1748, -1573, 
	-1204,   946,   652, -1670,  1204,   332, -1573,  1416, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 -805,   632,   435, -1116,   805,   222, -1051,   946, 
	  554,  -435,  -300,   769,  -554,  -153,   724,  -652, 
	 -283,   222,   153,  -392,   283,    78,  -369,   332, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	-1420,  1670,  -769,  -392,  1420, -1970,  1856, -1116, 
	 1338, -1573,   724,   369, -1338,  1856, -1748,  1051, 
	-1204,  1416,  -652,  -332,  1204, -1670,  1573,  -946, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 -805,   946,  -435,  -222,   805, -1116,  1051,  -632, 
	  554,  -652,   300,   153,  -554,   769,  -724,   435, 
	 -283,   332,  -153,   -78,   283,  -392,   369,  -222, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	-1420,  1970, -1856,  1670, -1420,  1116,  -769,   392, 
	 1338, -1856,  1748, -1573,  1338, -1051,   724,  -369, 
	-1204,  1670, -1573,  1416, -1204,   946,  -652,   332, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
	 -805,  1116, -1051,   946,  -805,   632,  -435,   222, 
	  554,  -769,   724,  -652,   554,  -435,   300,  -153, 
	 -283,   392,  -369,   332,  -283,   222,  -153,    78, 
};

// Precalculated int base values for 8x8 DCT, multplied by 8192:
constexpr std::array<int, 64> icos_base_8x8 =
{
	 8192,  8192,  8192,  8192,  8192,  8192,  8192,  8192, 
	11363,  9633,  6436,  2260, -2260, -6436, -9633, -11363, 
	10703,  4433, -4433, -10703, -10703, -4433,  4433, 10703, 
	 9633, -2260, -11363, -6436,  6436, 11363,  2260, -9633, 
	 8192, -8192, -8192,  8192,  8192, -8192, -8192,  8192, 
	 6436, -11363,  2260,  9633, -9633, -2260, 11363, -6436, 
	 4433, -10703, 10703, -4433, -4433, 10703, -10703,  4433, 
	 2260, -6436,  9633, -11363, 11363, -9633,  6436, -2260, 
};

// Precalculated int values for 1x8 IDCT, multplied by 8192:
constexpr std::array<int, 64> icos_idct_1x8 =
{
	 1024,  1420,  1338,  1204,  1024,   805,   554,   283, 
	 1024,  1204,   554,  -283, -1024, -1420, -1338,  -805, 
	 1024,   805,  -554, -1420, -1024,   283,  1338,  1204, 
	 1024,   283, -1338,  -805,  1024,  1204,  -554, -1420, 
	 1024,  -283, -1338,   805,  1024, -1204,  -554,  1420, 
	 1024,  -805,  -554,  1420, -1024,  -283,  1338, -1204, 
	 1024, -1204,   554,   283, -1024,  1420, -1338,   805, 
	 1024, -1420,  1338, -1204,  1024,  -805,   554,  -283, 
};

}

#endif